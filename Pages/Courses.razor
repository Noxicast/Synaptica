@page "/courses"

@using System.Collections.Generic
@using System.Threading.Tasks
@using Microsoft.EntityFrameworkCore
@using Synaptica.Shared.Models
@using Synaptica.Data
@using System.Data.SqlTypes
@inject SynpaticaDbContext DbContext
@inject Synaptica.Services.SessionService SessionService


<h3>Available Courses (WIP - currently not workign as intended, not loading courses even tho intended should)</h3>

@if (courses != null && courses.Count > 0)
{
    <div class="course-list">
        @foreach (var course in courses)
        {
            <div class="course-item">
                <h4>@(course.Title ?? "No Title Available")</h4>
                <p>@(course.Description ?? "No Description Available")</p>
                <p><strong>Duration:</strong> @(course.Duration ?? "No Duration Provided")</p>
                <button @onclick="() => Enroll(course)">Enroll</button>
            </div>
        }
    </div>
}
else
{
    <p>No courses available at the moment.</p>
}

@code {
    private List<Course> courses;

    protected override async Task OnInitializedAsync()
    {
        try
        {
            courses = await DbContext.Courses.ToListAsync();
        }
        catch (SqlNullValueException ex)
        {
            // Handle the situation where data contains null values
            Console.WriteLine("Data contains null values: " + ex.Message);
            courses = new List<Course>();
        }
    }

    private void Enroll(Course course)
    {
        // Placeholder method for enrolling in a course.
        // Currently does nothing.
    }
}
